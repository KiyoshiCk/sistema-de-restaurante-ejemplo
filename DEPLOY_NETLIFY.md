#!/bin/bash

# Guía de despliegue en Netlify

echo "╔════════════════════════════════════════════════════════════════╗"
echo "║       GUÍA DE DESPLIEGUE EN NETLIFY + BACKEND REMOTO           ║"
echo "╚════════════════════════════════════════════════════════════════╝"

echo ""
echo "PASO 1: DESPLEGAR FRONTEND EN NETLIFY"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "1.1 Accede a https://netlify.com"
echo "1.2 Conéctate con tu cuenta de GitHub"
echo "1.3 Haz clic en 'New site from Git'"
echo "1.4 Selecciona tu repositorio"
echo "1.5 En Build settings:"
echo "    - Build command: (dejar vacío o echo)"
echo "    - Publish directory: . (raíz)"
echo ""
echo "1.6 En Environment variables, agrega:"
echo "    VITE_API_URL = https://tu-backend-url.com/api"
echo ""

echo "PASO 2: DESPLEGAR BACKEND"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "Opciones recomendadas:"
echo ""
echo "2a) RAILWAY.APP (Recomendado)"
echo "   - URL: https://railway.app"
echo "   - Conecta tu repo de GitHub"
echo "   - Selecciona la carpeta 'backend'"
echo "   - Configura variables de entorno:"
echo "     * NODE_ENV=production"
echo "     * MONGODB_URI=mongodb+srv://..."
echo ""
echo "2b) RENDER.COM"
echo "   - URL: https://render.com"
echo "   - New Web Service"
echo "   - Conecta GitHub"
echo "   - Build command: cd backend && npm install"
echo "   - Start command: cd backend && npm start"
echo ""
echo "2c) HEROKU (Alternativa)"
echo "   - URL: https://heroku.com"
echo "   - Crea una nueva app"
echo "   - Conecta a GitHub"
echo ""

echo "PASO 3: CONFIGURAR VARIABLES DE ENTORNO"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "3.1 En Netlify (Frontend):"
echo "    - Site settings → Build & deploy → Environment"
echo "    - Agrega: VITE_API_URL = https://tu-backend.railway.app/api"
echo ""
echo "3.2 En Railway/Render (Backend):"
echo "    - MONGODB_URI = tu_url_mongodb_atlas"
echo "    - NODE_ENV = production"
echo ""

echo "PASO 4: ACTUALIZAR CLIENTE SI ES NECESARIO"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "En js/cliente.js y js/admin.js:"
echo "this.API_URL = window.__API_URL__ || 'http://localhost:3000/api';"
echo ""

echo "PASO 5: USAR MONGODB ATLAS"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "5.1 Accede a https://www.mongodb.com/cloud/atlas"
echo "5.2 Crea un cluster gratis"
echo "5.3 Crea un usuario de base de datos"
echo "5.4 Obtén la connection string:"
echo "    mongodb+srv://user:pass@cluster.mongodb.net/restaurante"
echo "5.5 Usa esta URL en MONGODB_URI"
echo ""

echo "VERIFICAR DESPLIEGUE"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "✓ Frontend accesible en https://tu-sitio.netlify.app"
echo "✓ Backend accesible en https://tu-backend.railway.app/api/health"
echo "✓ CORS habilitado en backend para tu dominio Netlify"
echo ""
